<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Caso pr√°ctico TDD ‚Äî JAFS</title>
  <meta name="description" content="Por poner el broche de oro a esta mini-serie de art√≠culos sobre TDD, vamos a ver un caso pr√°ctico con algo muy sencillo que todos conoc√©is: una pila. Por si ..." />
  <meta name="author" content="Jos√© Antonio Fuentes Santiago" />
  <meta name="keywords" content="Jos√© Antonio Fuentes Santiago, JAFS, Testing, TDD" />
  <meta name="article:published_time" content="2023-03-10T20:24:00.000Z" />
  

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://jafs.github.io/articles/posts/20230310.html" />
  <meta property="og:title" content="Caso pr√°ctico TDD" />
  <meta property="og:description" content="Por poner el broche de oro a esta mini-serie de art√≠culos sobre TDD, vamos a ver un caso pr√°ctico con algo muy sencillo que todos conoc√©is: una pila. Por si ..." />
  <meta property="og:site_name" content="JAFS" />
  <meta property="og:locale" content="es_ES" />
  
  <meta property="article:published_time" content="2023-03-10T20:24:00.000Z" />
  
  <meta property="article:author" content="Jos√© Antonio Fuentes Santiago" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Caso pr√°ctico TDD" />
  <meta name="twitter:description" content="Por poner el broche de oro a esta mini-serie de art√≠culos sobre TDD, vamos a ver un caso pr√°ctico con algo muy sencillo que todos conoc√©is: una pila. Por si ..." />
  

  <!-- Canonical URL -->
  <link rel="canonical" href="https://jafs.github.io/articles/posts/20230310.html" />

  <!-- Favicons -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <link rel="stylesheet" href="/css/dist.css">
  <link rel="stylesheet" href="/css/github-dark.min.css">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Caso pr√°ctico TDD",
  "author": {
    "@type": "Person",
    "name": "Jos√© Antonio Fuentes Santiago"
  },
  "publisher": {
    "@type": "Person",
    "name": "Jos√© Antonio Fuentes Santiago"
  },
  "description": "Por poner el broche de oro a esta mini-serie de art√≠culos sobre TDD, vamos a ver un caso pr√°ctico con algo muy sencillo que todos conoc√©is: una pila. Por si ...",
  "url": "https://jafs.github.io/articles/posts/20230310.html",
  "inLanguage": "es",
  "datePublished": "2023-03-10T20:24:00.000Z"
}
  </script>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="bg-black text-white py-4 shadow-md">
    <div class="max-w-4xl mx-auto px-4 flex items-center justify-between">
        <a href="/" class="text-2xl font-bold">
            <img src="/images/logo-mini.webp" alt="JAFS" class="inline-block w-8 h-8 mr-2 align-middle" />
        </a>
      <nav class="flex gap-4">
        <a href="/index.html" class="text-gray-300 hover:text-white transition-colors">Inicio</a>
        <a href="/articles/" class="text-gray-300 hover:text-white transition-colors">Art√≠culos</a>
        <a href="/books/" class="text-gray-300 hover:text-white transition-colors">Libros</a>
        <a href="/about.html" class="text-gray-300 hover:text-white transition-colors">Sobre m√≠</a>
      </nav>
    </div>
  </header>
  <main class="max-w-4xl mx-auto px-4 py-8">
    <article class="prose prose-lg max-w-none bg-white rounded-lg shadow-sm p-8">
      <h1 class="text-4xl font-bold mb-2">Caso pr√°ctico TDD</h1><p class="text-gray-600 text-sm mb-6">2023-03-10</p><p>Por poner el broche de oro a esta mini-serie de <a href="https://jafs.es/4060/testing-y-tdd/">art√≠culos sobre TDD</a>, vamos a ver un caso pr√°ctico con algo muy sencillo que todos conoc√©is: una pila. Por si queda alg√∫n despistado o despistada, una pila es una lista ordenada que permite almacenar y recuperar valores. El acceso a estos datos sigue el patr√≥n LIFO (del ingl√©s Last In, First Out, &quot;el √∫ltimo en entrar es el primero en salir&quot;). B√°sicamente, pod√©is pensar en la t√≠pica pila de platos, en la que el √∫ltimo plato que se pone encima, ser√° el primero que quitemos.</p>
<p>Para este caso, se usar√° JavaScript est√°ndar, haciendo uso de clases. De todas formas, si alguien tiene dudas sobre algo del lenguaje, pod√©is preguntarme en comentarios que responder√© con todo gusto.</p>
<h2 id="primer-test-crear-una-instancia">Primer test. Crear una instancia</h2>
<p>Como estamos usando TDD, lo primero de todo ser√° definir el test a probar:</p>
<pre><code class="language-typescript">describe(&quot;Stack&quot;, () =&gt; {
    test(&quot;should create a stack instance&quot;, () =&gt; {
        const stack = new Stack();
        expect(typeof stack).toBe(&quot;object&quot;);
     });
});
</code></pre>
<p>Si ahora ejecutamos el test, fallar√° como cabe espera:</p>
<pre><code class="language-text">    ReferenceError: Stack is not defined

      1 | describe(&quot;Stack&quot;, () =&gt; {
      2 |       test(&quot;should create a stack instance&quot;, () =&gt; {
    &gt; 3 |               const stack = new Stack();
        |                             ^
      4 |
      5 |               expect(typeof stack).toBe(&quot;object&quot;);
      6 |       });

      at Object.&lt;anonymous&gt; (stack.test.js:3:17)
</code></pre>
<p>Tenemos que escribir el c√≥digo m√≠nimo para que el test pase, as√≠ que, crearemos la clase:</p>
<pre><code class="language-typescript">class Stack {
}
</code></pre>
<p>Y tendremos nuestro test pasado:</p>
<pre><code class="language-text"> PASS  ./stack.test.js
  Stack
    ‚àö should create a stack instance (2 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.412 s, estimated 1 s
</code></pre>
<p>De aqu√≠ en adelante, ya no os pondr√© la salida de error y de passed por consola üòâ.</p>
<h2 id="segundo-test-null-al-quitar-un-elemento-de-la-pila-vac√≠a">Segundo test. Null al quitar un elemento de la pila vac√≠a</h2>
<p>En este segundo test, vamos a verificar que si ejecutamos la operaci√≥n de quitar un elemento de la pila, y esta se encuentra vac√≠a, se devuelve el valor <code>null</code>.</p>
<pre><code class="language-typescript">test(&quot;should return null when pop an empty stack&quot;, () =&gt; {
    const stack = new Stack();

    expect(stack.pop()).toBeNull();
});
</code></pre>
<p>Para hacer que el test pase, como tenemos que escribir el c√≥digo m√≠nimo, simplemente crearemos un m√©todo <code>pop()</code> que devolver√° <code>null</code> al ejecutarlo.</p>
<pre><code class="language-typescript">class Stack {
    pop() {
        return null;
    }
}
</code></pre>
<h2 id="tercer-test-a√±adir-un-valor-y-eliminarlo">Tercer test. A√±adir un valor y eliminarlo</h2>
<p>Ahora tenemos que probar que si a√±adimos un valor y lo eliminamos se obtiene ese mismo valor.</p>
<pre><code class="language-typescript">test(&quot;should add value in the top of the stack and return this value when do a pop&quot;, () =&gt; {
    const stack = new Stack();

    stack.push(&quot;hello&quot;);

    expect(stack.pop()).toBe(&quot;hello&quot;);
});
</code></pre>
<p>Ahora el c√≥digo de la clase deber√≠a seguir haciendo lo m√≠nimo posible, pero vamos a ir un paso m√°s all√° (para no eternizar el ejemplo), y nos vamos a la fase de refactor, tras la que tendr√≠amos:</p>
<pre><code class="language-typescript">class Stack {
    #lastValue = null;

    push(value) {
        this.#lastValue = value;
    }

    pop() {
        return this.#lastValue;
    }
}
</code></pre>
<h2 id="cuarto-test-devolver-null-si-no-quedan-elementos-por-quitar">Cuarto test. Devolver null si no quedan elementos por quitar</h2>
<pre><code class="language-typescript">test(&quot;should return null after pop the last element&quot;, () =&gt; {
    const stack = new Stack();

    stack.push(&quot;value&quot;);
    stack.pop();

    expect(stack.pop()).toBeNull();
});

class Stack {
    #lastValue = null;

    push(value) {
        this.#lastValue = value;
    }

    pop() {
        const lastValue = this.#lastValue;
        this.#lastValue = null;
        return lastValue;
    }
}
</code></pre>
<p>Obs√©rvese que como a√∫n no hemos gestionado m√°s de un objeto en la cola, no estamos controlando que haya varios, es por ello que en este paso, asignaremos a <code>null</code> el valor, en cuanto llamemos a <code>pop()</code>. Y esto es por la regla de escribir el m√≠nimo c√≥digo posible.</p>
<h2 id="quinto-test-a√±adir-y-eliminar-varios-valores-a-la-pila">Quinto test. A√±adir y eliminar varios valores a la pila</h2>
<pre><code class="language-typescript">test(&quot;should add several values to the top and remove then until arrive to null&quot;, () =&gt; {
    const stack = new Stack();

    stack.push(&quot;value1&quot;);
    stack.push(&quot;value2&quot;);
    stack.push(&quot;value3&quot;);

    expect(stack.pop()).toBe(&quot;value3&quot;);
    expect(stack.pop()).toBe(&quot;value2&quot;);
    expect(stack.pop()).toBe(&quot;value1&quot;);
    expect(stack.pop()).toBeNull();
});
</code></pre>
<p>Es necesario hacer una aclaraci√≥n en esta parte, ya que si en el test, s√≥lo hubi√©semos a√±adido la √∫ltima comprobaci√≥n, omitiendo el resto de <code>expects</code>, no se hubiera podido verificar la pila nos devuelve cada valor eliminado, y seg√∫n el c√≥digo que ya ten√≠amos, el test pasar√≠a. Es por ello, que tenemos que dar mucha importancia a qu√© se quiere probar, porque un test que no est√© bien escrito, es como si no existiera. En estos casos tambi√©n es importante tener en cuenta, que si escribimos un test, y pasa sin tocar nada de c√≥digo, puede que no estemos probando lo que queremos.</p>
<p>Tras un refactor, en este caso tendremos lo siguiente:</p>
<pre><code class="language-typescript">class StackElement {
    #value = null;
    #previousElement = null;

    constructor(value, previousElement) {
        this.#value = value;
        this.#previousElement = previousElement;
    }

    get Value() {
        return this.#value;
    }

    get PreviousElement() {
        return this.#previousElement;
    }
}

class Stack {
    #lastElement = null;

    push(value) {
        this.#lastElement = new StackElement(value, this.#lastElement);
    }

    pop() {
        if (!this.#lastElement) {
            return null;
        }

        const lastValue = this.#lastElement.Value;
        this.#lastElement = this.#lastElement.PreviousElement;
        return lastValue;
    }
}
</code></pre>
<p>Se ha incluido una nueva clase, y en este caso, no hemos a√±adido tests para dicha clase, ya que es un getter/setter. A√±adir tests en estos casos no tendr√≠a mucho sentido. Sin embargo, si hubi√©semos necesitado una clase m√°s compleja. Si que en este momento pausar√≠amos el test actual, para comenzar el desarrollo de la nueva clase con TDD. Una vez que hiciera todo lo que necesitamos, volver√≠amos a este test.</p>
<h2 id="sexto-test-devolver-longitud-0-cuando-la-pila-est√°-vac√≠a">Sexto test. Devolver longitud 0 cuando la pila est√° vac√≠a</h2>
<pre><code class="language-typescript">test(&quot;should return zero when stack is empty&quot;, () =&gt; {
    const stack = new Stack();

    expect(stack.Length).toBe(0);
});

class Stack {
    #lastElement = null;

    get Length() {
        return 0;
    }
    
    // El resto del c√≥digo no tiene cambios
}
</code></pre>
<h2 id="s√©ptimo-test-obtener-el-n√∫mero-de-elementos-a√±adidos">S√©ptimo test. Obtener el n√∫mero de elementos a√±adidos</h2>
<pre><code class="language-typescript">test(&quot;should return the number of elements in stack after add some values&quot;, () =&gt; {
    const stack = new Stack();

    stack.push(1);
    stack.push(2);
    stack.push(3);

    expect(stack.Length).toBe(3);
});

class Stack {
    #lastElement = null;
    #length = 0;

    get Length() {
        return this.#length;
    }

    push(value) {
        this.#lastElement = new StackElement(value, this.#lastElement);
        ++this.#length;
    }

    // El resto del c√≥digo no tiene cambios
}
</code></pre>
<p>En este punto, como el test s√≥lo ha probado el a√±adir elementos, no tenemos que tocar el resto del c√≥digo, s√≥lo la parte de a√±adir. Aunque sea cansino, recordad que vamos a m√≠nimos en cada paso.</p>
<h2 id="√∫ltimo-test-obtener-el-n√∫mero-de-elementos-tras-a√±adir-y-eliminar-varios-elementos">√öltimo test. Obtener el n√∫mero de elementos tras a√±adir y eliminar varios elementos</h2>
<pre><code class="language-typescript">test(&quot;should return the number of elements in stack after add and remove some values&quot;, () =&gt; {
    const stack = new Stack();

    stack.push(1);
    stack.push(2);
    stack.pop();
    stack.push(3);
    stack.pop();

    expect(stack.Length).toBe(1);
});

class Stack {
    #lastElement = null;
    #length = 0;

    get Length() {
        return this.#length;
    }

    push(value) {
        this.#lastElement = new StackElement(value, this.#lastElement);
        ++this.#length;
    }

    pop() {
        if (!this.#lastElement) {
            return null;
        }

        const lastValue = this.#lastElement.Value;
        this.#lastElement = this.#lastElement.PreviousElement;
        --this.#length;
        return lastValue;
    }
}
</code></pre>
<h2 id="conclusiones">Conclusiones</h2>
<p>Despu√©s de haber visto un caso de uso de TDD, creo que podemos concluir que esta t√©cnica es una herramienta valiosa para garantizar la calidad del software y mejorar la eficiencia del proceso de desarrollo. Al escribir las pruebas antes de escribir el c√≥digo, se obliga a pensar cuidadosamente en los requisitos del software y en c√≥mo se comportar√° en diferentes situaciones. El enfoque incremental de TDD tambi√©n significa que el software se desarrolla en peque√±os pasos, lo que facilita la detecci√≥n de errores y la resoluci√≥n de problemas antes de que se conviertan en problemas mayores.</p>
    </article>
  </main>
  <footer class="bg-black text-white py-4 mt-12">
    <div class="max-w-4xl mx-auto px-4 flex flex-col items-center gap-4">
      <div class="flex gap-4">
        <a href="https://www.linkedin.com/in/joseafs/" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300 transition-colors" aria-label="LinkedIn">
          <img src="/images/linkedin.svg" alt="LinkedIn" class="w-6 h-6" />
        </a>
        <a href="https://www.instagram.com/jafs_developer/" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300 transition-colors" aria-label="Instagram">
          <img src="/images/instagram.svg" alt="Instagram" class="w-6 h-6" />
        </a>
      </div>
      <div class="text-center">¬© 2025 ‚Äî Jos√© Antonio Fuentes Santiago</div>
    </div>
  </footer>
  <script src="/js/highlight.min.js"></script>
  <script src="/js/main.js"></script>
</body>
</html>