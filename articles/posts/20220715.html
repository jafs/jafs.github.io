<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AbortController: cancela operaciones en JavaScript — JAFS</title>
  <meta name="description" content="Hasta ahora, en JavaScript, cuando se lanzaba una llamada a una API con fetch, no resultaba sencillo detenerla. También se podía dar el caso de que quisiéram..." />
  <meta name="author" content="José Antonio Fuentes Santiago" />
  <meta name="keywords" content="José Antonio Fuentes Santiago, JAFS, programación, JavaScript" />
  <meta name="article:published_time" content="2022-07-15T18:00:00.000Z" />
  

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://jafs.github.io/articles/posts/20220715.html" />
  <meta property="og:title" content="AbortController: cancela operaciones en JavaScript" />
  <meta property="og:description" content="Hasta ahora, en JavaScript, cuando se lanzaba una llamada a una API con fetch, no resultaba sencillo detenerla. También se podía dar el caso de que quisiéram..." />
  <meta property="og:site_name" content="JAFS" />
  <meta property="og:locale" content="es_ES" />
  <meta property="og:image" content="/images/abort-controller-mini.webp" />
  
  <meta property="article:published_time" content="2022-07-15T18:00:00.000Z" />
  
  <meta property="article:author" content="José Antonio Fuentes Santiago" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="AbortController: cancela operaciones en JavaScript" />
  <meta name="twitter:description" content="Hasta ahora, en JavaScript, cuando se lanzaba una llamada a una API con fetch, no resultaba sencillo detenerla. También se podía dar el caso de que quisiéram..." />
  <meta name="twitter:image" content="/images/abort-controller-mini.webp" />
  

  <!-- Canonical URL -->
  <link rel="canonical" href="https://jafs.github.io/articles/posts/20220715.html" />

  <!-- Favicons -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <link rel="stylesheet" href="/css/dist.css">
  <link rel="stylesheet" href="/css/github-dark.min.css">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "AbortController: cancela operaciones en JavaScript",
  "author": {
    "@type": "Person",
    "name": "José Antonio Fuentes Santiago"
  },
  "publisher": {
    "@type": "Person",
    "name": "José Antonio Fuentes Santiago"
  },
  "description": "Hasta ahora, en JavaScript, cuando se lanzaba una llamada a una API con fetch, no resultaba sencillo detenerla. También se podía dar el caso de que quisiéram...",
  "url": "https://jafs.github.io/articles/posts/20220715.html",
  "inLanguage": "es",
  "datePublished": "2022-07-15T18:00:00.000Z",
  "image": "/images/abort-controller-mini.webp"
}
  </script>

</head>
<body class="bg-gray-50 text-gray-900">
  <header class="bg-black text-white py-4 shadow-md">
    <div class="max-w-4xl mx-auto px-4 flex items-center justify-between">
      <a href="/" class="text-2xl font-bold">
        <img src="/images/logo-mini.webp" alt="JAFS" class="inline-block w-8 h-8 mr-2 align-middle" />
      </a>
      <div class="flex items-center gap-4">
        <nav class="flex gap-4">
          <a href="/index.html" class="text-gray-300 hover:text-white transition-colors">Inicio</a>
          <a href="/articles/" class="text-gray-300 hover:text-white transition-colors">Artículos</a>
          <a href="/books/" class="text-gray-300 hover:text-white transition-colors">Libros</a>
          <a href="/about.html" class="text-gray-300 hover:text-white transition-colors">Sobre mí</a>
        </nav>
        <form action="/search.html" method="get">
          <input type="search" name="q" placeholder="Buscar..." class="px-3 py-2 rounded bg-gray-800 text-white text-sm placeholder-gray-400 border border-gray-700 focus:outline-none focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 w-40" aria-label="Buscar artículos" />
        </form>
      </div>
    </div>
  </header>
  <main class="max-w-4xl mx-auto px-4 py-8">
    <article class="prose prose-lg max-w-none bg-white rounded-lg shadow-sm p-8">
      <h1 class="text-4xl font-bold mb-2">AbortController: cancela operaciones en JavaScript</h1><p class="text-gray-600 text-sm mb-6">2022-07-15</p><p>Hasta ahora, en JavaScript, cuando se lanzaba una llamada a una API con fetch, no resultaba sencillo detenerla. También se podía dar el caso de que quisiéramos detener varias operaciones que se ejecutaban de simultáneamente de forma centralizada, por lo que teníamos que implementar sistemas como el patrón observador.</p>
<p>Pero en la actualidad, estos flujos ahora son más fáciles gracias a la clase <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController">AbortController</a> que viene a proporcionarnos una forma de enviar una señal de parada a todo elemento que lo utilice. Básicamente, tendremos una señal (<code>AbortSignal</code>) que se emitirá cuando queramos cancelar una operación.</p>
<p>Veamos el uso más básico, y que está en miles de ejemplos:</p>
<pre><code class="language-javascript">const abortController = new AbortController();
const abortSignal = abortController.signal;

fetch(&quot;http://urldelaapi/to/api/call&quot;, { signal: abortSignal })
    .then(function(response) {
      console.log(&quot;Respuesta obtenida&quot;, response);
    })
    .catch(function(e) {
      console.log(&quot;Algo ha fallado o lo han cancelado: &quot; + e.message);
    });

// Tras alguna interacción del usuario por ejemplo, cancelamos la operación.
abortController.abort();
</code></pre>
<p>En el código anterior podemos ver como el uso de AbortController se reduce a obtener su señal, con <code>signal</code>, y a llamar al método <code>abort()</code> para lanzar la señal.</p>
<p>Aunque es una herramienta muy potente, no hay mucho más que explicar... bueno sí, el 99,9% de los ejemplos que podéis encontrar, son como el que he puesto en las líneas anteriores, pero, ¿y si queréis usar la clase AbortController en algo que no sea un fetch? ¿Cómo se puede escuchar el cambio en la señal? Pues a continuación he preparado un código muy sencillito. En él podéis ver como hay tres contadores avanzando, lo que haremos es detenerlos mediante una señal:</p>
<iframe height="300" style="width: 100%;" scrolling="no" title="AbortController with event listener" src="https://codepen.io/jafs-developer/embed/poaMBbm?default-tab=js%2Cresult&theme-id=dark" frameborder="no" loading="lazy" allowtransparency="true">
  Ver el Pen <a href="https://codepen.io/jafs-developer/pen/poaMBbm">
  AbortController with event listener</a> by José Antonio Fuentes Santiago (<a href="https://codepen.io/jafs-developer">@jafs-developer</a>)
  on <a href="https://codepen.io">CodePen</a>.
</iframe>
<p>Lo que hemos hecho es definir una clase Timer a la que pasamos la señal de abortar la operación:</p>
<pre><code class="language-javascript">// El controler viene de: controller = new AbortController();
const timer1 = new Timer(&quot;timer1&quot;, controller.signal);
const timer2 = new Timer(&quot;timer2&quot;, controller.signal);
const timer3 = new Timer(&quot;timer3&quot;, controller.signal);
</code></pre>
<p>En el constructor escuchamos el evento <code>abort</code> para dicha señal asociándolo con un event listener e indicando al código a ejecutar cuando llegue dicha señal. En nuestro caso el método <code>#onAbort()</code>:</p>
<pre><code class="language-javascript">// No usamos .bind porque #onAbort está declarado como arrow function.
this.#signal.addEventListener(&quot;abort&quot;, this.#onAbort);
</code></pre>
<p>Podemos, además enviar una cadena para indicar la razón por la que hemos enviado la señal. Esta razón se recogerá en el atributo <code>reason</code> del evento.</p>
<pre><code class="language-javascript">// Tras declarar el controler, recuerda: controller = new AbortController();
// Se especifica la razón
controller.abort(&quot;Stopped by user&quot;);

// Con event.currentTarget.reason podemos obtener dicho valor
console.warn(`Stopped ${this.#name} by: ${event.currentTarget.reason}`);
</code></pre>
<p>Como punto final, imaginad que tenéis varias llamadas simultáneas a un API porque es necesario solicitar datos en paralelo en vuestra aplicación. Ahora pongámonos en una situación en la que el usuario quiere cancelar la carga de datos en paralelo, por ejemplo, abrió una modal que hace varias llamadas y la cierra inmediatamente. Podemos detener de forma centralizada todas estas llamadas (al igual que hicimos con el ejemplo de los temporizadores):</p>
<pre><code class="language-javascript">class AnyModal {
  #abortController = null;

  async openModal() {
    // Si ya había una petición en curso, la cancelamos antes de empezar
    // la nueva
    if (this.#abortController) {
      this.#abortController.abort();
    }

    this.#abortController = new AbortController();
    const abortSignal = this.#abortController.signal;

    try {
      const [r1, r2, r3] = await Promise.all([
        fetch(&quot;https://example.com/api/call/1&quot;, { signal }),
        fetch(&quot;https://example.com/api/call/2&quot;, { signal }),
        fetch(&quot;https://example.com/api/call/3&quot;, { signal })
      ]);
      // manejar respuestas
    } catch (err) {
      if (err.name === &quot;AbortError&quot;) {
        console.log(&quot;Carga cancelada por el usuario&quot;);
      } else {
        console.error(&quot;Error en llamadas:&quot;, err);
      }
    } finally {
      // Liberamos el controller cuando todo ha terminado (exitoso o no)
      this.#abortController = null;
    }
  }

  closeModal() {
    if (this.#abortController) {
      this.#abortController.abort();
      this.#abortController = null;
    }
  }
}
</code></pre>
<p>Como habéis podido comprobar, AbortController es una herramienta muy sencilla a la par que potente, y que nos puede dar muchos más usos de los que he comentado aquí. Como siempre, espero que este breve artículo os haya servido de ayuda.</p>

    </article>
  </main>
  <footer class="bg-black text-white py-4 mt-12">
    <div class="max-w-4xl mx-auto px-4 flex flex-col items-center gap-4">
      <div class="flex gap-4">
        <a href="https://www.linkedin.com/in/joseafs/" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300 transition-colors" aria-label="LinkedIn">
          <img src="/images/linkedin.svg" alt="LinkedIn" class="w-6 h-6" />
        </a>
        <a href="https://www.youtube.com/@jafsdeveloper" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300 transition-colors" aria-label="YouTube">
          <img src="/images/youtube.svg" alt="YouTube" class="w-6 h-6" />
        </a>
        <a href="https://www.instagram.com/jafs_developer/" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-300 transition-colors" aria-label="Instagram">
          <img src="/images/instagram.svg" alt="Instagram" class="w-6 h-6" />
        </a>
      </div>
      <div class="text-center">© 2025 — José Antonio Fuentes Santiago</div>
    </div>
  </footer>
  <script src="/js/highlight.min.js"></script>
  <script src="/js/main.js"></script>
</body>
</html>